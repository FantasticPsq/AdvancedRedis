### Redis整数集合 ###
1. 重点内容
```text
1.整数集合是集合键的底层实现之一
2.整数集合的底层实现为数组，这个数组以有序、无重复的方式保存集合元素，
再有需要时，程序会根据新添加元素的类型，改变这个数组的类型。
3.升级操作为整数集合带来了操作上的灵活性，并且尽可能地节约内存
4.整数集合只支持升级操作，不支持降级操作
```

2. 整数集合的实现
整数集合(inset)是Redis用于保存整数值的集合抽象数据结构，它可以保存类型为
int16_t,int32_t,int64_t的整数值，并且保证集合钟不会出现重复元素。
```c
typedef struct intset {
    //编码方式
    uint32_t encoding;
    // 集合包含的元素数量
    uint32_t length;
    // 保存元素的数组
    int8_t contents[];
```
contents数组是整数集合的底层实现：整数集合的每个元素都是contents数组的一个数组项(item),   
各个项在数组中按从小到大的顺序有序的排列着，并且数组中不包含重复项。length表示元素个数，   
也就是数组长度。虽然intset结构将contents申明为int8_t类型的数组，但实际上contents数组并不    
保存任何int8_t类型的值，content数组的真正类型取决于encoding属性的值；   
1. 如果encoding的值INTSET_ENC_INT16,那么contents数组就是一个int16_t类型的数组，数组里
每个项都是一个int16_t类型的整数值。
2. 如果encoding的值INTSET_ENC_INT32,那么contents数组就是一个int32_t类型的数组，数组里
每个项都是一个int32_t类型的整数值。
3. 如果encoding的值INTSET_ENC_INT64,那么contents数组就是一个int64_t类型的数组，数组里
每个项都是一个int64_t类型的整数值。

3. 整数集合的升级   
当我们需要向整数集合中添加一个新的元素，并且新元素的类型比整数集合现有所有元素的类型都要长   
时，整数集合需要先进行升级(upgrade),然后才能将新元素添加到整数集合里面。   
升级整数集合并添加新元素共分为三步进行：
    1. 根据新元素的类型，拓展整数集合底层数组的空间大小，并为新元素分配空间
    2. 将底层数组现有的所有元素转换为新元素的类型，并将类型转换后的元素放到正确的位置，而且    
    放置元素的过程中，需要维持底层数组的有序性不变
    3. 将要添加的元素添加到底层数组中

4. 升级的好处
    1. 提高灵活性
    整数集合可以通过自动升级底层数组来适应新元素，我们可以随意将int16_t,int32_t,int64_t类型的
    数据添加到集合中，而不必担心类型错误。
    2. 节约内存
    如果直接用int64_t类型的数组作为整数集合的底层实现，是可以同时保存int16_t，int32_t，int64_t三种   
    类型的值的，但是如果集合中都是int16_t或者int32_t类型的数，那么，就会导致浪费内存。   
    而整数集合现在的方式不仅可以让集合能同时保存三种不同的类型的值，又可以确保升级操作只会在有需要的时候   
    进行，这可以尽量节省内内存。   
    
    整数集合无降级操作，升级后会一直保持升级后的类型。